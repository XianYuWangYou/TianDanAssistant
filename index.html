<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档表格批量填写助手</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #019883;
            --primary-dark: #017a6a;
            --secondary-color: #4a86e8;
            --light-gray: #f5f5f5;
            --medium-gray: #e0e0e0;
            --dark-gray: #333;
            --darker-gray: #222;
            --border-color: #ddd;
            --white: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 6px 16px rgba(0, 0, 0, 0.15);
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --info: #2196f3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .main-content {
            display: flex;
            gap: 12px;
        }

        .tab-buttons {
            display: flex;
            flex-direction: column;
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            width: 180px;
            flex-shrink: 0;
        }

        .tab-button {
            padding: 16px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .tab-button i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .tab-button:hover {
            background-color: var(--light-gray);
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
        }

        .tab-content {
            display: none;
            background: var(--white);
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.3s ease;
            flex: 1;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--light-gray);
            font-weight: 600;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--darker-gray);
            text-align: center;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 15px;
            transition: border-color 0.3s, box-shadow 0.3s;
            text-align: center;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(1, 152, 131, 0.2);
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }

        button:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
        }

        .btn-secondary:hover {
            background-color: #3a76d8;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #d32f2f;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #388e3c;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .card {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 12px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .card-header {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.1rem;
            text-align: center;
        }

        .card-header i {
            font-size: 1.2rem;
        }

        .list-container {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            min-height: 200px;
            max-height: 350px;
            overflow-y: auto;
            padding: 12px;
            background-color: #fafafa;
        }

        .list-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
            text-align: center;
        }

        .list-item:hover {
            background-color: var(--light-gray);
            border-radius: 4px;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .placeholder-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
            text-align: center;
        }

        .placeholder-item:hover {
            background-color: var(--light-gray);
            border-radius: 4px;
        }

        .placeholder-item:last-child {
            border-bottom: none;
        }

        .actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .scrollable-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            background-color: #fafafa;
        }

        .status-bar {
            background: var(--light-gray);
            padding: 15px 20px;
            border-radius: 6px;
            margin-top: 25px;
            font-size: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-align: center;
        }

        .file-info {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
            text-align: center;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .input-group input {
            flex: 1;
        }

        .input-group button {
            flex-shrink: 0;
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-align: center;
        }

        .badge-primary {
            background-color: rgba(1, 152, 131, 0.15);
            color: var(--primary-color);
        }

        .badge-secondary {
            background-color: rgba(74, 134, 232, 0.15);
            color: var(--secondary-color);
        }

        .developer-info {
            text-align: right;
            font-size: 0.9rem;
            color: #666;
            margin-top: 20px;
            padding: 10px 5px;
        }

        .hidden {
            display: none;
        }

        .file-input {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s;
        }

        @media (max-width: 992px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 15px;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .tab-buttons {
                width: 100%;
                flex-direction: row;
            }
            
            .tab-button {
                justify-content: center;
                text-align: center;
                padding: 16px 10px;
                flex-direction: column;
                gap: 5px;
            }
            
            .tab-button i {
                width: auto;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .actions button {
                width: 100%;
            }
            
            .input-group {
                flex-direction: column;
            }
        }

        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="template">
                    <i class="fas fa-file-alt"></i>
                    <span>模板制作</span>
                </button>
                <button class="tab-button" data-tab="scheme">
                    <i class="fas fa-cogs"></i>
                    <span>方案配置</span>
                </button>
                <button class="tab-button" data-tab="data">
                    <i class="fas fa-keyboard"></i>
                    <span>数据录入</span>
                </button>
                <button class="tab-button" data-tab="settings">
                    <i class="fas fa-cog"></i>
                    <span>设置选项</span>
                </button>
            </div>

            <!-- 模板制作标签页 -->
            <div id="template" class="tab-content active">
                <h2><i class="fas fa-file-alt"></i> 模板制作</h2>
                <div class="two-column">
                    <div class="card">
                        <div class="card-header">
                            <span><i class="fas fa-copy"></i> 模板文件列表</span>
                        </div>
                        <div class="list-container" id="template-list">
                            <div class="list-item">
                                <span>请添加模板文件</span>
                            </div>
                        </div>
                        <div class="actions">
                            <button id="select-template-folder"><i class="fas fa-folder-open"></i> 选择模板文件</button>
                            <button class="btn-danger" id="remove-selected-template"><i class="fas fa-trash-alt"></i> 移除选中</button>
                            <button class="btn-secondary" id="open-document"><i class="fas fa-external-link-alt"></i> 打开文档</button>
                        </div>
                        <input type="file" id="template-file-input" class="file-input" multiple accept=".docx,.xlsx">
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <span><i class="fas fa-tags"></i> 占位符管理</span>
                        </div>
                        <div class="form-group">
                            <label for="new-placeholder">添加新占位符</label>
                            <div class="input-group">
                                <input type="text" id="new-placeholder" placeholder="输入占位符名称，例如：{姓名}">
                                <button id="add-placeholder"><i class="fas fa-plus"></i> 添加</button>
                            </div>
                        </div>
                        <div class="actions">
                            <button class="btn-danger" id="delete-selected-placeholder"><i class="fas fa-trash-alt"></i> 删除选中</button>
                        </div>
                        <div class="list-container" id="placeholder-list" style="margin-top: 15px;">
                            <div class="placeholder-item">
                                <span>请添加占位符</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 方案配置标签页 -->
            <div id="scheme" class="tab-content">
                <h2><i class="fas fa-cogs"></i> 方案配置</h2>
                <div class="two-column">
                    <div class="card">
                        <div class="card-header">
                            <span><i class="fas fa-file-contract"></i> 文档列表</span>
                        </div>
                        <div class="list-container" id="document-list">
                            <div class="list-item">
                                <span>请添加文档</span>
                            </div>
                        </div>
                        <div class="actions">
                            <button id="select-document"><i class="fas fa-file-import"></i> 选择文档</button>
                            <button class="btn-danger" id="remove-selected-document"><i class="fas fa-trash-alt"></i> 移除选中</button>
                            <button class="btn-secondary" id="identify-placeholder"><i class="fas fa-search"></i> 识别占位符</button>
                        </div>
                        <input type="file" id="document-file-input" class="file-input" multiple accept=".docx,.xlsx">
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <span><i class="fas fa-keyboard"></i> 占位符录入</span>
                        </div>
                        <div class="scrollable-container" id="placeholder-input-container">
                            <div class="form-group">
                                <p>请先选择文档并识别占位符</p>
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="scheme-name">方案名称</label>
                            <input type="text" id="scheme-name" placeholder="输入方案名称">
                        </div>
                        <div class="actions">
                            <button class="btn-success" id="save-scheme"><i class="fas fa-save"></i> 保存方案</button>
                            <button class="btn-danger" id="delete-scheme"><i class="fas fa-trash-alt"></i> 删除方案</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 数据录入标签页 -->
            <div id="data" class="tab-content">
                <h2><i class="fas fa-keyboard"></i> 数据录入</h2>
                <div class="two-column">
                    <div class="card">
                        <div class="form-group">
                            <label for="select-scheme"><i class="fas fa-list"></i> 选择方案</label>
                            <select id="select-scheme">
                                <option value="">请选择方案</option>
                            </select>
                        </div>
                        
                        <div class="actions">
                            <button id="select-output-dir"><i class="fas fa-folder"></i> 选择输出目录</button>
                            <button class="btn-success" id="generate-document"><i class="fas fa-file-export"></i> 生成文档</button>
                            <button class="btn-secondary" id="merge-pdf"><i class="fas fa-file-pdf"></i> 合并为PDF</button>
                        </div>
                        
                        <div class="status-bar" id="data-status-bar">
                            <i class="fas fa-info-circle"></i>
                            <span>就绪</span>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <span><i class="fas fa-edit"></i> 信息录入区</span>
                        </div>
                        <div class="scrollable-container" id="data-input-container">
                            <div class="form-group">
                                <p>请先选择方案</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 设置选项标签页 -->
            <div id="settings" class="tab-content">
                <h2><i class="fas fa-cog"></i> 设置选项</h2>
                <div class="card">
                    <div class="form-group">
                        <label for="output-dir">默认输出目录</label>
                        <input type="text" id="output-dir" value="docs">
                    </div>
                    <div class="form-group">
                        <label for="theme">界面主题</label>
                        <select id="theme">
                            <option>浅色主题</option>
                            <option>深色主题</option>
                        </select>
                    </div>
                    <div class="actions">
                        <button class="btn-success" id="save-settings"><i class="fas fa-save"></i> 保存设置</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="developer-info">咸鱼网友/XianYuWengou</div>
    </div>

    <script>
        // 全局变量
        let templateFiles = [];
        let documentFiles = [];
        let placeholders = [];
        let currentScheme = null;
        let schemes = {};

        // 标签页切换功能
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                // 移除所有活动状态
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // 添加活动状态到当前选中项
                button.classList.add('active');
                const tabId = button.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // 模板制作页面功能
        document.getElementById('select-template-folder').addEventListener('click', () => {
            document.getElementById('template-file-input').click();
        });

        document.getElementById('template-file-input').addEventListener('change', (event) => {
            const files = Array.from(event.target.files);
            files.forEach(file => {
                if (!templateFiles.includes(file.name)) {
                    templateFiles.push(file.name);
                }
            });
            updateTemplateList();
        });

        function updateTemplateList() {
            const container = document.getElementById('template-list');
            container.innerHTML = '';
            
            if (templateFiles.length === 0) {
                container.innerHTML = '<div class="list-item"><span>请添加模板文件</span></div>';
                return;
            }
            
            templateFiles.forEach(file => {
                const ext = file.split('.').pop().toLowerCase();
                let badgeClass = 'badge-primary';
                let fileType = 'Word';
                
                if (ext === 'xlsx') {
                    badgeClass = 'badge-secondary';
                    fileType = 'Excel';
                }
                
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <span>${file}</span>
                    <span class="badge ${badgeClass}">${fileType}</span>
                `;
                container.appendChild(item);
            });
        }

        // 方案配置页面功能
        document.getElementById('select-document').addEventListener('click', () => {
            document.getElementById('document-file-input').click();
        });

        document.getElementById('document-file-input').addEventListener('change', (event) => {
            const files = Array.from(event.target.files);
            files.forEach(file => {
                if (!documentFiles.includes(file.name)) {
                    documentFiles.push(file.name);
                }
            });
            updateDocumentList();
        });

        function updateDocumentList() {
            const container = document.getElementById('document-list');
            container.innerHTML = '';
            
            if (documentFiles.length === 0) {
                container.innerHTML = '<div class="list-item"><span>请添加文档</span></div>';
                return;
            }
            
            documentFiles.forEach(file => {
                const ext = file.split('.').pop().toLowerCase();
                let badgeClass = 'badge-primary';
                let fileType = 'Word';
                
                if (ext === 'xlsx') {
                    badgeClass = 'badge-secondary';
                    fileType = 'Excel';
                }
                
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `
                    <span>${file}</span>
                    <span class="badge ${badgeClass}">${fileType}</span>
                `;
                container.appendChild(item);
            });
        }

        // 识别占位符功能
        document.getElementById('identify-placeholder').addEventListener('click', async () => {
            if (documentFiles.length === 0) {
                alert('请先选择文档');
                return;
            }
            
            // 在实际应用中，这里会调用后端API来识别占位符
            // 模拟一些占位符
            placeholders = ['姓名', '身份证号', '日期', '地址', '电话'];
            updatePlaceholderInputs();
        });

        function updatePlaceholderInputs() {
            const container = document.getElementById('placeholder-input-container');
            container.innerHTML = '';
            
            if (placeholders.length === 0) {
                container.innerHTML = '<div class="form-group"><p>未识别到占位符</p></div>';
                return;
            }
            
            placeholders.forEach(placeholder => {
                const group = document.createElement('div');
                group.className = 'form-group';
                group.innerHTML = `
                    <label>${placeholder}:</label>
                    <input type="text" placeholder="请输入${placeholder}" data-placeholder="${placeholder}">
                `;
                container.appendChild(group);
            });
        }

        // 数据录入页面功能
        // 模拟加载方案
        function loadSchemes() {
            // 在实际应用中，这里会从后端加载方案
            schemes = {
                "方案1": {
                    placeholders: ["姓名", "身份证号", "日期"]
                },
                "方案2": {
                    placeholders: ["姓名", "电话", "地址", "日期"]
                }
            };
            
            const select = document.getElementById('select-scheme');
            select.innerHTML = '<option value="">请选择方案</option>';
            
            Object.keys(schemes).forEach(schemeName => {
                const option = document.createElement('option');
                option.value = schemeName;
                option.textContent = schemeName;
                select.appendChild(option);
            });
        }

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', () => {
            updateTemplateList();
            updateDocumentList();
            loadSchemes();
        });

        // 选择方案时更新输入区域
        document.getElementById('select-scheme').addEventListener('change', (event) => {
            const schemeName = event.target.value;
            if (schemeName && schemes[schemeName]) {
                currentScheme = schemes[schemeName];
                updateDataInputs();
            } else {
                currentScheme = null;
                document.getElementById('data-input-container').innerHTML = '<div class="form-group"><p>请先选择方案</p></div>';
            }
        });

        function updateDataInputs() {
            const container = document.getElementById('data-input-container');
            container.innerHTML = '';
            
            if (!currentScheme || !currentScheme.placeholders) {
                container.innerHTML = '<div class="form-group"><p>方案数据不完整</p></div>';
                return;
            }
            
            currentScheme.placeholders.forEach(placeholder => {
                const group = document.createElement('div');
                group.className = 'form-group';
                group.innerHTML = `
                    <label>${placeholder}:</label>
                    <input type="text" placeholder="请输入${placeholder}" data-placeholder="${placeholder}">
                `;
                container.appendChild(group);
            });
        }

        // 生成文档功能
        document.getElementById('generate-document').addEventListener('click', async () => {
            if (!currentScheme) {
                alert('请先选择方案');
                return;
            }
            
            // 收集用户输入
            const inputs = {};
            document.querySelectorAll('#data-input-container input').forEach(input => {
                const placeholder = input.getAttribute('data-placeholder');
                inputs[placeholder] = input.value;
            });
            
            // 检查必填项
            let isValid = true;
            Object.keys(inputs).forEach(key => {
                if (!inputs[key]) {
                    isValid = false;
                }
            });
            
            if (!isValid) {
                alert('请填写所有字段');
                return;
            }
            
            // 在实际应用中，这里会调用后端API生成文档
            document.getElementById('data-status-bar').innerHTML = `
                <i class="fas fa-info-circle"></i>
                <span>文档生成中...</span>
            `;
            
            // 模拟处理过程
            setTimeout(() => {
                document.getElementById('data-status-bar').innerHTML = `
                    <i class="fas fa-check-circle" style="color: #4caf50;"></i>
                    <span>文档生成完成！</span>
                `;
            }, 2000);
        });
    </script>
</body>
</html>